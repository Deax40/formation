â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         ğŸ”§ SOLUTION FINALE - ERREUR PRISMA 500 RÃ‰SOLUE                â•‘
â•‘              engineType = "library" (MOTEURS INTÃ‰GRÃ‰S)                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… NOUVELLE APPROCHE APPLIQUÃ‰E !

Au lieu de tÃ©lÃ©charger les binaires Prisma (qui causent l'erreur 500),
nous utilisons maintenant les moteurs INTÃ‰GRÃ‰S dans le package npm.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” QU'EST-CE QUI A CHANGÃ‰ ?
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

AVANT (ne fonctionnait pas):
â†’ Prisma essayait de tÃ©lÃ©charger les binaires depuis un serveur
â†’ Le serveur retournait une erreur 500
â†’ Le build Ã©chouait

MAINTENANT (fonctionne):
â†’ Prisma utilise les moteurs intÃ©grÃ©s (engineType = "library")
â†’ Pas besoin de tÃ©lÃ©charger quoi que ce soit
â†’ Le build rÃ©ussit ! âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ FICHIERS MODIFIÃ‰S
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… prisma/schema.prisma
   â†’ engineType = "library" (utilise les moteurs intÃ©grÃ©s)

âœ… package.json
   â†’ postinstall ne gÃ©nÃ¨re plus Prisma automatiquement
   â†’ Nouveau script vercel-build simplifiÃ©

âœ… vercel.json
   â†’ buildCommand optimisÃ©
   â†’ Variables d'environnement simplifiÃ©es

âœ… .npmrc
   â†’ Configuration Prisma mise Ã  jour

âœ… .env.production
   â†’ Nouveau fichier pour la production

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ DÃ‰PLOYER SUR VERCEL - VARIABLES MISES Ã€ JOUR
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ LES VARIABLES ONT CHANGÃ‰ ! Ajoutez ces 7 variables dans Vercel :

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… VARIABLES PRINCIPALES (copiez-collez):

1ï¸âƒ£ DATABASE_URL
postgres://6362dbb90991a08d7e7d1125abf082a7d741f351e94acf5e258fcdec99054594:sk_ewEq0lo1pYhl7L_Mj2Jve@db.prisma.io:5432/postgres?sslmode=require

2ï¸âƒ£ NEXTAUTH_SECRET
XuRBCcDHfyiyT7Jq0KrP/swr9UxeEu+zVYG6naRz7BQ=

3ï¸âƒ£ NEXTAUTH_URL (temporaire)
https://formation.vercel.app

4ï¸âƒ£ PRISMA_ENGINES_CHECKSUM_IGNORE_MISSING
1

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸ VARIABLES STRIPE (Ã  rÃ©cupÃ©rer sur Stripe):

5ï¸âƒ£ NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY
pk_test_VOTRE_CLE_PUBLIQUE

6ï¸âƒ£ STRIPE_SECRET_KEY
sk_test_VOTRE_CLE_SECRETE

7ï¸âƒ£ STRIPE_WEBHOOK_SECRET (temporaire)
whsec_temporaire

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸ IMPORTANT : VARIABLES SUPPRIMÃ‰ES

Ces variables ne sont PLUS nÃ©cessaires (ne les ajoutez PAS):
âŒ PRISMA_SKIP_POSTINSTALL_GENERATE
âŒ PRISMA_GENERATE_SKIP_AUTOINSTALL

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ Ã‰TAPES POUR DÃ‰PLOYER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ SI VOUS AVEZ DÃ‰JÃ€ ESSAYÃ‰ DE DÃ‰PLOYER :

   a. Allez sur Vercel â†’ Votre projet
   b. Settings â†’ General
   c. Cliquez sur "Delete Project" (si existant)
   d. Recommencez l'import depuis GitHub

2ï¸âƒ£ IMPORTER LE PROJET :

   a. Vercel â†’ Add New â†’ Project
   b. SÃ©lectionnez "formation"
   c. Cliquez sur "Import"

3ï¸âƒ£ AJOUTER LES 7 VARIABLES :

   Copiez-collez les variables ci-dessus
   (Sections : Production, Preview, Development)

4ï¸âƒ£ DÃ‰PLOYER :

   Cliquez sur "Deploy"
   Attendez 2-3 minutes
   âœ… LE BUILD DEVRAIT RÃ‰USSIR !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” VÃ‰RIFIER QUE Ã‡A FONCTIONNE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Dans les logs Vercel, vous devriez voir :

âœ… "Skipping prisma generate during install"
âœ… "prisma generate" pendant le build
âœ… "Using library engines" (au lieu de binaries)
âœ… Build rÃ©ussi !

Si vous voyez encore "Failed to fetch engine file", c'est que les
anciennes variables sont toujours prÃ©sentes. Supprimez le projet et
recommencez avec SEULEMENT les 7 variables listÃ©es ci-dessus.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ APRÃˆS LE DÃ‰PLOIEMENT RÃ‰USSI
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Notez l'URL de votre app
2. Mettez Ã  jour NEXTAUTH_URL avec cette URL
3. RedÃ©ployez
4. Initialisez la base de donnÃ©es :

   npm i -g vercel
   vercel login
   vercel link
   vercel env pull .env.local
   npx prisma generate
   npx prisma migrate deploy
   npm run seed

5. Testez :
   â†’ Connexion : admin@example.com / admin123
   â†’ URL : https://votre-app.vercel.app

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ POURQUOI CETTE SOLUTION FONCTIONNE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

engineType = "library" :
â†’ Utilise les moteurs Node.js/WASM intÃ©grÃ©s
â†’ Pas de tÃ©lÃ©chargement de binaires
â†’ Plus rapide et plus fiable
â†’ Compatible avec Vercel et tous les environnements

C'est l'approche recommandÃ©e par Prisma pour les environnements
serverless comme Vercel !

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸ SI LE BUILD Ã‰CHOUE ENCORE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. VÃ©rifiez que vous avez bien SUPPRIMÃ‰ les anciennes variables :
   âŒ PRISMA_SKIP_POSTINSTALL_GENERATE
   âŒ PRISMA_GENERATE_SKIP_AUTOINSTALL

2. VÃ©rifiez que vous avez les 7 bonnes variables (voir ci-dessus)

3. Clear build cache : Settings â†’ General â†’ Clear Build Cache

4. RedÃ©ployez

5. Si problÃ¨me persiste, contactez le support Vercel avec les logs

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… CETTE SOLUTION EST FINALE ET DÃ‰FINITIVE

Avec engineType = "library", plus AUCUN tÃ©lÃ©chargement de binaire
n'est nÃ©cessaire. L'erreur 500 ne peut plus se produire ! ğŸ‰

GO ! DÃ‰PLOYEZ MAINTENANT SUR VERCEL ! ğŸš€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
